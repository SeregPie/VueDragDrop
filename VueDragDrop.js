!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueDragDrop=e()}(this,function(){"use strict";function e(t){return function(){return t}}function i(t){return"function"==typeof t?t:e(t)}var t={tag:{type:String,default:"div"},revertDuration:{type:Number,default:0},restrict:{},data:{}};function a(){}function c(t,o){var i={};return Object.entries(t).forEach(function(t){var e=t[0],n=t[1];i[e]=o(n,e)}),i}var n={windowEventListeners:function(){var e=this;return c({mousemove:this.onMouseMove,mouseup:this.onMouseUp},function(t){return t.bind(e)})}};var o=function(t){return Array.isArray(t)?t.map(o):(e=t)&&"object"==typeof e?c(t,o):t;var e};var r={emitDrag:function(){var t=this.position,e=this.data;t=o(t),this.$emit("drag",{position:t,data:e})},emitDragEnd:function(){var t=this.position,e=this.data;t=o(t),this.$emit("drag-end",{position:t,data:e})},emitDragStart:function(){var t=this.position,e=this.data;t=o(t),this.$emit("drag-start",{position:t,data:e})}};function s(e,n){var o,i;o=function(t){requestAnimationFrame(function(){!1!==e()&&setTimeout(t,n)})},(i=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return o.call.apply(o,[this,i].concat(t))})()}var u={name:"VueDragItem",mixins:[function(t){var e=t.get,n=t.default;e=i(e);var o={};return Object.keys(n).forEach(function(n){o[n]=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return this.strategy[n].apply(this,t)}}),{data:function(){return{getPartialStrategy:e}},computed:{strategy:function(){return Object.assign({},n,this.getPartialStrategy(function(t){this.getPartialStrategy=t?i(t):e}.bind(this)))}},methods:o}}({get:function(e){return{onTouchStart:function(t){1===t.touches.length&&(t.preventDefault(),e({onTouchMove:function(t){1===t.touches.length&&(t.preventDefault(),this.dragged=!0,this.pointerPosition={left:t.touches[0].clientX,top:t.touches[0].clientY},this.emitDragStart(),this.emitDrag(),e({onTouchMove:function(t){1===t.touches.length&&(t.preventDefault(),this.pointerPosition={left:t.touches[0].clientX,top:t.touches[0].clientY},this.emitDrag())},onTouchEnd:function(t){1===t.changedTouches.length&&(t.preventDefault(),this.pointerPosition={left:t.changedTouches[0].clientX,top:t.changedTouches[0].clientY},this.dragged=!1,this.emitDragEnd(),e())}}))},onTouchEnd:function(t){1===t.changedTouches.length&&(t.preventDefault(),e())}}))},onMouseDown:function(t){1===t.which&&(t.preventDefault(),e({onMouseMove:function(t){t.preventDefault(),this.dragged=!0,this.pointerPosition={left:t.clientX,top:t.clientY},this.emitDragStart(),this.emitDrag(),e({onMouseMove:function(t){t.preventDefault(),this.pointerPosition={left:t.clientX,top:t.clientY},this.emitDrag()},onMouseUp:function(t){1===t.which&&(t.preventDefault(),this.pointerPosition={left:t.clientX,top:t.clientY},this.dragged=!1,this.emitDragEnd(),e())}})},onMouseUp:function(t){1===t.which&&(t.preventDefault(),e())}}))}}},default:{onTouchStart:a,onTouchMove:a,onTouchEnd:a,onMouseDown:a,onMouseMove:a,onMouseUp:a}})],props:t,data:function(){return{dragged:!1,pointerPosition:{left:0,top:0}}},computed:n,methods:r,mounted:function(){var t=this;Object.entries(this.windowEventListeners).forEach(function(t){var e=t[0],n=t[1];window.addEventListener(e,n)}),s(function(){if(t._isDestroyed)return!1},1e3);var e=this.$refs;e.ghost&&document.body.appendChild(e.ghost)},beforeDestroy:function(){Object.entries(this.windowEventListeners).forEach(function(t){var e=t[0],n=t[1];window.removeEventListener(e,n)})},render:function(t){var e=this,n=this.$scopedSlots,o=this.dragged,i=this.pointerPosition,r=this.tag,s=(n=Object.assign({},{default:a,ghost:a},n)).default({dragged:o}),u=n.ghost({dragged:o});return t(r,{style:{display:"inline-block"}},[t("div",{style:{position:"relative"},on:c({touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,mousedown:this.onMouseDown},function(t){return t.bind(e)})},[s]),t(r,{style:{position:"absolute",zIndex:999999,left:i.left+"px",top:i.top+"px"},ref:"ghost"},[u])])}},h=e(!0);var f={name:"VueDropArea",props:{tag:{type:String,default:"div"},accept:{type:Function,default:h},data:{}},mounted:function(){var t=this;s(function(){if(t._isDestroyed)return!1},1e3)},render:function(t){var e=this.$scopedSlots;return t(this.tag,{style:{display:"inline-block"}},[(e=Object.assign({},{default:a},e)).default({dragged:{inside:!0}})])}},d=Object.freeze({DragItem:u,DropArea:f}),p=Object.assign({},{install:function(e){Object.values(this.components).forEach(function(t){e.component(t.name,t)})},components:d},d);return"undefined"!=typeof window&&window.Vue&&window.Vue.use(p),p});
