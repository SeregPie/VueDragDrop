!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueDragDrop=e()}(this,function(){"use strict";function s(t){return function(){return t}}function r(t){return"function"==typeof t}var u="staged_";var t={tag:{type:String,default:"div"},revertDuration:{type:Number,default:0},restrict:{},data:{}},i={width:0,height:0},n={left:0,top:0,width:1/0,height:1/0};function h(){}function o(t,e,n){return Math.min(Math.max(t,e),n)}var e={eventListeners:function(){return Object.assign({},{onTouchStart:h,onTouchMove:h,onTouchEnd:h,onMouseDown:h,onMouseMove:h,onMouseUp:h},this.activeEventListeners)},ghostBounds:function(){return Object.assign({},this.ghostPosition,this.ghostSize)},ghostOffsetPosition:function(){var t=this.elementRelativeStartPointerPosition,e=this.ghostSize;return{left:t.left*e.width,top:t.top*e.height}},ghostPosition:function(){var t=this.ghostOffsetPosition,e=this.ghostSize,n=this.pointerPosition,i=this.restrictBounds;return{left:o(n.left-t.left,i.left,i.left+i.width-e.width),top:o(n.top-t.top,i.top,i.top+i.height-e.height)}},elementRelativeStartPointerPosition:function(){var t=this.startPointerPosition,e=this.getElementBounds();return{left:(t.left-e.left)/e.width,top:(t.top-e.top)/e.height}},windowEventListeners:function(){return{mousemove:this.onMouseMove,mouseup:this.onMouseUp}}};var c={activeEventListeners:function(e){return{onTouchStart:function(t){1===t.touches.length&&(t.preventDefault(),Object.assign(this.startPointerPosition,{left:t.touches[0].clientX,top:t.touches[0].clientY}),e({onTouchMove:function(t){1===t.touches.length&&(t.preventDefault(),this.active=!0,Object.assign(this.pointerPosition,{left:t.touches[0].clientX,top:t.touches[0].clientY}),e({onTouchMove:function(t){1===t.touches.length&&(t.preventDefault(),Object.assign(this.pointerPosition,{left:t.touches[0].clientX,top:t.touches[0].clientY}))},onTouchEnd:function(t){1===t.changedTouches.length&&(t.preventDefault(),Object.assign(this.pointerPosition,{left:t.touches[0].clientX,top:t.touches[0].clientY}),this.active=!1,e())}}))},onTouchEnd:function(t){1===t.changedTouches.length&&(t.preventDefault(),e())}}))},onMouseDown:function(t){1===t.which&&(t.preventDefault(),Object.assign(this.startPointerPosition,{left:t.clientX,top:t.clientY}),e({onMouseMove:function(t){t.preventDefault(),this.active=!0,Object.assign(this.pointerPosition,{left:t.clientX,top:t.clientY}),e({onMouseMove:function(t){t.preventDefault(),Object.assign(this.pointerPosition,{left:t.clientX,top:t.clientY})},onMouseUp:function(t){1===t.which&&(t.preventDefault(),Object.assign(this.pointerPosition,{left:t.clientX,top:t.clientY}),this.active=!1,e())}})},onMouseUp:function(t){1===t.which&&(t.preventDefault(),e())}}))}}},emiters:function(i){if(this.active){var t=this.data,e=this.ghostPosition;return i(function(){var t=this.active,e=this.data,n=this.ghostPosition;return t?[["drag",{data:e,position:Object.assign({},n)}]]:(i(),[["drag-end",{data:e,position:Object.assign({},n)}]])}),[["drag-start",{data:t,position:Object.assign({},e)}]]}}};var a={emiters:function(t){var i=this;t&&t.forEach(function(t){var e=t[0],n=t[1];i.$emit(e,n)})}},f=["onTouchStart","onTouchMove","onTouchEnd","onMouseDown","onMouseMove","onMouseUp"].reduce(function(t,n){var e;return Object.assign(t,((e={})[n]=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];this.eventListeners[n].apply(this,t)},e))},{}),d={left:0,top:0,width:0,height:0};var l=Object.assign({},f,{getElementBounds:function(){var t=this.$el;if(t){var e=t.getBoundingClientRect();return{left:e.left,top:e.top,width:e.width,height:e.height}}return d},getGhostSize:function(){var t=this.$refs;if(t){var e=t.ghost;if(e){var n=e.getBoundingClientRect();return{width:n.width,height:n.height}}}return i},getRestrictBounds:function(){var t,e=this.restrict;return r(e)&&(e=e()),(t=e)&&t._isVue&&(e=e.$el),e instanceof HTMLElement&&(e=e.getBoundingClientRect()),e?{left:e.left,top:e.top,width:e.width,height:e.height}:n},updateGhostSize:function(){Object.assign(this.ghostSize,this.getGhostSize())},updateRestrictBounds:function(){Object.assign(this.restrictBounds,this.getRestrictBounds())}});function p(e,n){var i,o;i=function(t){requestAnimationFrame(function(){!1!==e()&&setTimeout(t,n)})},(o=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return i.call.apply(i,[this,o].concat(t))})()}var g,v,b={name:"VueDragItem",mixins:[(g=c,v={},Object.entries(g).forEach(function(t){var i=t[0],n=t[1],o=function(e){var n=this;void 0===e&&(e=0),this.$nextTick(function(){var t;"number"==typeof e?n[u+i].splice(e):n[u+i].push(r(t=e)?t:s(t))})};v[i]=function(){return(t=[n].concat(this[u+i]),t[(e=t,e.length-1)]).call(this,o.bind(this));var t,e}}),{data:function(){var e={};return Object.keys(g).forEach(function(t){e[u+t]=[]}),e},computed:v})],props:t,data:function(){return{active:!1,ghostSize:Object.assign({},i),pointerPosition:{left:0,top:0},restrictBounds:Object.assign({},n),startPointerPosition:{left:0,top:0}}},computed:e,watch:a,methods:l,mounted:function(){var t=this,e=this.windowEventListeners;Object.entries(e).forEach(function(t){var e=t[0],n=t[1];window.addEventListener(e,n)}),p(function(){if(t._isDestroyed)return!1;t.updateGhostSize(),t.updateRestrictBounds()},1e3/60);var n=this.$refs;n.ghost&&document.body.appendChild(n.ghost)},beforeDestroy:function(){var t=this.windowEventListeners;Object.entries(t).forEach(function(t){var e=t[0],n=t[1];window.removeEventListener(e,n)})},render:function(t){var e=this.$scopedSlots,n=this.active,i=this.tag;e=Object.assign({},{default:h,ghost:h},e);var o,s={},r={position:"absolute",zIndex:999999};if(n){var u=this.ghostPosition;Object.assign(s,{dragged:{position:u}}),Object.assign(r,{left:u.left+"px",top:u.top+"px"}),o=e.ghost(s)}var c=e.default(s);return t(i,{style:{display:"inline-block"}},[t("div",{style:{position:"relative"},on:{touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,mousedown:this.onMouseDown}},[c]),t("div",{style:r,ref:"ghost"},[o])])}},m=s(!0);var w={name:"VueDropArea",props:{tag:{type:String,default:"div"},accept:{type:Function,default:m},data:{}},mounted:function(){var t=this;p(function(){if(t._isDestroyed)return!1},1e3)},render:function(t){var e=this.$scopedSlots;return t(this.tag,{style:{display:"inline-block"}},[(e=Object.assign({},{default:h},e)).default({dragged:{inside:!0}})])}},O=Object.freeze({DragItem:b,DropArea:w}),j=Object.assign({},{install:function(e){Object.values(this.components).forEach(function(t){e.component(t.name,t)})},components:O},O);return"undefined"!=typeof window&&window.Vue&&window.Vue.use(j),j});
